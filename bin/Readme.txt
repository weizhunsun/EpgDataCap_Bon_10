BonDriverを使用したEPGデータの取得、予約録画を行うためのツール群です。


◆このプログラムを使用して発生した全ての問題に対して責任は持ちません。


■注意■
　すべてを新規作成したので人柱１０以前の過去バージョンとは互換性がなく
　なっています。
　設定ファイルも互換性がないため、人柱１０以前からのバージョンアップの
　場合は一度すべてを削除してください。
　まだ動作の不安定な部分やおかしい部分などが残っている可能性があります。


■動作環境■
OS    ：Windows XP SP3以降
CPU   ：Intel Core 2 Duo以上推奨
メモリ：1GB以上推奨

動作には.NetFramework4.0とVC++2010のランタイムが必要です。
x86はB25Decoder.dll用にVC++2005のランタイムが必要です。

Microsoft .NET Framework 4 (スタンドアロンのインストーラー)
http://www.microsoft.com/downloads/details.aspx?familyid=0A391ABD-25C1-4FC0-919F-B21F31AB88B7&displaylang=ja
Microsoft Visual C++ 2010 再頒布可能パッケージ (x86)
http://www.microsoft.com/downloads/details.aspx?FamilyID=a7b7a05e-6de6-4d3a-a423-37bf0912db84&displaylang=ja
Microsoft Visual C++ 2010 再頒布可能パッケージ (x64)
http://www.microsoft.com/downloads/details.aspx?familyid=BD512D9E-43C8-4655-81BF-9350143D5867&displaylang=ja


■64bitOSへの対応■
　x64フォルダにあるモジュールは64bitでビルドしたモジュールになっていま
　す。64bitネイティブで動作することが可能です。
　64bit版を使用するにはBonDriverも64bitでビルドされている必要があります。
　32bitのモジュールが１つでも必要な場合は使用できません。


■ソース（src.zip）の取り扱いについて■
　特にGPLとかにはしないのでフリーソフトに限っては自由に改変してもらった
　り組み込んでもらって構わないです。
　改変したり組み込んだりして公開する場合は該当部分のソースぐらいは一緒
　に公開してください。（強制ではないので別に公開しなくてもいいです）
　商用、シェアウェアなどに許可なく組み込むのは不可です。


■EpgDataCap3.dll、CtrlCmdCLI.dll、SendTSTCP.dll、BonDriver_TCP.dllの
取り扱いについて
　フリーソフトに組み込む場合は特に制限は設けません。
　このdllを使用したことによって発生した問題について保証は一切行いません。
　商用、シェアウェアなどに許可なく組み込むのは不可です。

■twitter.dllの取り扱いについて
　他のDLLとは異なり、そのまま他のソフトで使用するのは不可です。
　APIキーを所得し、ビルドし直したものを使用するのは構いません。
　商用、シェアウェアなどに許可なく組み込むのは不可です。

■基本的な使用準備■
　１．64bitOSで64bitネイティブで動作させるには「x64」フォルダを、
　　　それ以外の場合は「x86」フォルダを使用してください。

　２．使用デバイス用のBonDriverを用意し、BonDriver フォルダに入れる。
　　　BonDriverによってはiniファイルなどで設定できる内容があるので、あ
　　　らかじめ設定をしておく

　３．EpgDataCap_Bon.exeを起動し、「設定」→「基本設定」タブで「設定関
　　　係保存フォルダ」を設定する。

　４．チューナーから使用チューナーを選んで「チャンネルスキャン」を行う。
　　　地デジで5分程はかかると思います。
　　　使用するチューナーの種類が複数の場合は同じ事を行う。
　　　同時に複数起動して、チャンネルスキャンを行うことができます。

　５．全てのチューナーのチャンネルスキャンが完了するまで待ちます。

　６．EpgDataCap_Bon.exeを終了する。
　　　（複数起動している場合は、チャンネルスキャンが終了したものから終
　　　わらせてください）

　８．EpgTimer.exeを起動する。

　９．「設定」→「チューナー設定」タブで各BonDriverで使用するチューナー
　　　数とEPGデータの取得に使用するかを設定します。
　　　◆チューナー数が正しく設定されないと、正常に動作しません◆

１０．「EPG取得設定」タブでEPG取得対象サービスを設定します。

１１．EpgTimer.exeを終了する。

１２．EpgTimer.exeを起動する。

１３．基本的な使用準備は終わり。
　　　EPG取得を行い、必要に応じて各種設定や、予約登録など行う。

EpgDataCap_Bon.exeの詳細はReadme_EpgDataCap_Bon.txt
EpgTimer.exeの詳細はReadme_EpgTimer.txt
を参照してください。

◆チューナーによって地デジの受信チャンネルが異なる特殊な受信環境の場合、
◆同一サービスのチャンネルが複数、チャンネルスキャンで引っかかっている
◆可能性があります。
◆正常に受信できる１チャンネル分のサービスのみ残して、他のチャンネルの
◆サービスは削除してください。
◆（EpgDataCap_Bon.exeで表示されるspace、chの値を参考に、設定->サービス
◆表示設定より削除）
◆同一サービスが複数あると予約録画などの動作が正常に動作しない可能性が
◆あります。


■バグ報告について
　http://2sen.dip.jp/dtv/の掲示板をバグ報告用として利用させて頂いてます
　が、アクセス規制の煽りを食らって書き込みやアップロードできない状態に
　なることがあります。
　バグ報告に関するレスは修正という形で取らせてもらうのが大半になると思
　います。
　バグ報告以外の内容に関しては基本的に対応は行いません。
　要望に関しては簡単にできそうな物なら組み込んでいこうと考えています。
　◆バグ報告には、使用環境（ハード、アプリ、BonDriver、バージョンなど）、
　◆何から予約登録を行い、どのような設定でだったかなどの詳細も記載願い
　◆ます。
　◆多種多様な環境を構築できるようになってきたため、詳細の記載なき報告
　◆は基本的に確認を行いません（行えません）。
　◆DbgView、DbgMonなどを使用してログの取得を行ってもらえると、解決の糸
　◆口が見つかりやすくなります。（特にチャンネルスキャンや予約録画に関
　◆する問題の場合）


■更新履歴■
11/01/10　人柱版１０．２０
・EpgTimerNWにEPGデータを自動的に読み込まない設定を追加（EPG再読み込みでデータロード）
・即時録画時のキャンセルで確認ダイアログが出るように変更
・Write_Default.dllで上書き保存設定でもエラーになった場合は別ファイル名で保存するように変更
11/01/05　人柱版１０．１９
・EpgTimerNWの自動予約登録のプログラム予約で曜日の選択に問題あったので修正
・空き容量不足で別ドライブへの保存変更が発生した場合に、データを一部保存できていなかったのを修正
・ストリーミング再生時にサーバーがスタンバイ／休止に移行した場合、送信処理を終了するように変更
・録画後動作の抑制条件に追っかけ再生、ストリーミング再生を行っている場合を追加
・EpgDataCap_Bonに次回起動時に終了前のサービスで起動する設定を追加
（強制的に起動時のサービス指定したい場合はReadme_EpgDataCap_Bon.txtを参照）
・検索結果のダブルクリックから予約登録/変更ダイアログが出るように変更
10/12/30　人柱版１０．１８
・TVTest用PlugInでストリーミング再生中ではないときにGUIが表示されるのを修正
・EpgTimerNWの録画設定のデフォルト設定で録画モードが保存されなくなっていたのを修正
・終了時間未定の追従が発生したときに、録画開始のツイートを連続で送ることがあったのを修正
（最初の開始時のみツイートします）
10/12/26　人柱版１０．１７
・ストリーミング再生時に自動的にBonDriverと受信ポートを変更するように変更
・ストリーミング再生時のGUIに終了ボタンを追加
・特定の動作状況をTwitterにツイートする機能を追加
・予約割り振りで同一物理チャンネルで連続となるチューナーの使用を優先する設定を追加
10/12/25　人柱版１０．１６
・自動削除機能の仕様を変更
（録画予定フォルダ内での削除で足りない場合に、登録されてる削除フォルダ全体から削除処理実行）
・予約配置の内部最適化処理前に、チューナー不足になる予約がある場合に問題あったので修正
・TVTest用PlugInにストリーミング再生対応機能を追加（追っかけ再生、ストリーミング再生機能を使うには必須になります）
・追っかけ再生機能を追加（録画中のものをUDP or TCPで送信します。TVTest連携の設定が必要です）
・EpgTimerNWにストリーミング再生機能を追加（TVTest連携の設定が必要です）
・EpgTimerNWのカスタムボタン機能に実装抜けあったので修正
・録画設定のデフォルトで設定が保存されていない項目があったので修正
・EpgTimerNWでファイル名マクロなしが設定できなかったので修正
・EpgTimerNWに起動時に前回のサーバーに接続する設定を追加
・EpgTimerNWに休止/スタンバイ移行時にEpgTimerNWを終了する設定を追加
10/12/12　人柱版１０．１５
・録画モードでデコードなしの設定でもデコードしていたので修正
（ただし、ネットワーク送信を開始したり、他のサービスでデコードする設定に
なっているものがある場合はデコード処理します）
・視聴モードの処理がいくつか未実装だったので実装
・ChSetのファイル作成時の処理変更
Twitter機能はDLLがあればそのまま使えます
10/12/05　人柱版１０．１４
・録画設定のデフォルト値にファイル名PlugInの設定が反映されていなかったので修正
10/12/04　人柱版１０．１３
・録画設定にファイル名PlugInを指定できる項目追加（個別録画フォルダとして設定）
・検索条件にジャンルと時間絞り込みをNOT扱いにできる設定を追加
・BS1とBS2のBitrate.iniの値を変更
・NetWorkTV終了処理に問題あったので修正
10/11/23　人柱版１０．１２
・予約割り振りの処理を少し変更
・EPGデータ読み込み中の排他制御を少し強化
・番組表以外のツールチップを表示しない設定を追加
・EpgTimerNWの右クリックメニューに再生が残っていたので削除
・同一チャンネルの別サービスの予約が登録できなくなっていたので修正
10/11/21　人柱版１０．１１
・放送波時間でPC時計と同期する設定を追加（Vista以降ではEpgTimerSrv.exeが
　管理者権限で起動（サービスとして起動など）している必要があります）
・EpgDataCap_Bonからの手動でのサービス切り替え時は物理チャンネルを考慮
　するように変更（予約録画時に物理チャンネル考慮できないのは仕様）
・予約削除時にメモリリークあったので修正
・予約割り振り時にメモリリークあったので修正
・NetWorkTV終了時にTVTestも終了するように変更
・エラー処理少し強化
10/11/19　人柱版１０．１０
・録画済み一覧自動削除の設定値が間違っていたので修正
10/11/18　人柱版１０．９
・予約情報更新時に内部保持リストのリセットができていなかったので修正
・EPG取得でデッドロック発生する可能性あったので修正
・録画済み一覧の自動削除機能追加
10/11/14　人柱版１０．８
・番組表の表示に問題あったので修正
10/11/14　人柱版１０．７
・自動削除の削除対象フォルダの判定に問題あったので修正
・ネットワークドライブの空き容量がうまく取得できていなかったので修正
・サービス表示設定の削除で選択項目以外が削除されることあったので修正
10/11/10　人柱版１０．６
・追従処理に問題あったので修正
・録画結果の種類追加
10/11/07　人柱版１０．５
・追従処理少し変更
・番組表の予約枠に一部実行の色を変更できる設定を追加
・番組表のツールチップを表示しない設定を追加
・番組情報変更時の情報更新に一部問題あったので修正
・EpgTimerNWにぴったり？録画の項目が表示されてなかったので修正
10/10/30　人柱版１０．４
・TVTest連携にNetworkTVモードを追加（EpgDataCap_BonからUDP or TCP送信するモード）
・ボタンに「NetworkTV終了」を追加
・動作設定に録画時のプロセス優先度指定できる設定追加
・エラーログにSignal値を追加
・EpgTimerNWにカスタムボタンとTVTest連携（NetworkTVモードのみ）を追加
（起動するプロセスはローカルPCのものになります）
・テストコード残っていたので削除
10/10/25　人柱版１０．３
・番組情報変更時の情報更新に一部問題あったので修正
・GC.Collect()を行うようにしてみた
10/10/20　人柱版１０．２
・自動予約登録の録画モード無効時の動作がおかしくなっていたので修正
・EpgTimerNWに休止とスタンバイのボタンを追加
　（※ローカルマシンではなく、接続先のサーバーに対する動作になります）
・EpgTimerNWの接続時にIPの変わりにドメイン名を指定できるように変更
10/10/17　人柱版１０．１
・録画後バッチのマクロに「$Drops$」、「$Scrambles$」、「$Result$」を追加
・自動予約登録時にイベントグループ考慮するように変更
・textにいくつか追記
10/10/08　人柱版１０
・NOTキーワードはあいまい検索を行わないように変更
・textは一部まだ書きかけ


■動作確認環境■
OS    　　：Windows7 Ultimate 64bit版
CPU   　　：Intel Core i7 860
メモリ　　：4GB
VGA       ：ATI Radeon HD 4670
チューナー：PT1×1、PT2×1
