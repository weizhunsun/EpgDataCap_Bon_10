EpgDataCap_Bon用予約録画タイマー

EpgTimer.exeはEpgTimerSrv.exeのGUIフロントエンドとなっており、実際の制
御はEpgTimerSrv.exeが行なっています。

EpgTimerNW.exeはEpgTimerのネットワーク版となっており、ローカルに対する
設定、処理関係以外は同等の機能を備えたものになっています。
サーバーとなるPCのEpgTimer側でネットワーク接続が許可されている必要があ
ります。

最新の変更内容はReadme.txtの更新履歴を参照してください。

■使用前の準備■
　Readme.txtの■基本的な使用準備■を参照


■主な機能■
・指定時間に録画用アプリを起動して録画を行う
・放送波の時間情報を利用して録画開始などのタイミングを調整（1分以内の誤
　差を想定）
・予約の追従、延長が可能
・録画用アプリを利用して番組情報自動取得が可能
・EPGデータから番組検索を行い予約登録が可能
・HDDの空きがない場合、録画ファイルを自動的に削除することが可能
・iEPG対応
・予約録画終了後、バッチファイルの起動が可能
・スタンバイ or 休止移行時にプロセスの起動状態によって移行を抑制可能
・EpgTimerSrv.exeをサービスに登録することでログオンなしで録画することが
　可能
・BonDriverレベルでの受信可能チャンネルの差異を考慮して使用チューナー
　を割り振ります
・同一物理チャンネルのサービスは1チューナーで録画（想定使用用途：CS録画）
・録画時にHDDの空きを確保（できるだけ連続領域を確保）してから開始
・複数フォルダ同時出力（想定使用用途：HDDとSDに保存とか）
・HDDの空きがない時用のサブ録画フォルダを設定可能
・部分受信（ワンセグ）の同時保存が可能（サイマル放送前提）
・サーバー連携を行うことでチューナー不足の予約を別サーバーに登録可能
・サーバー連携を行うことで別サーバーの最新EPGデータを取得可能

■使い方■
　チャンネルスキャンの結果とEPGデータを元に動作します。
　EPGデータは1日1回は取得するようにしてください。
　EpgTimer.exe（EpgTimerSrv.exe）は常時起動した状態にしてください。

　●予約の登録方法
　　◆番組表から◆
　　　　番組表タブから、該当の番組をダブルクリックすると予約登録ダイア
　　　　ログが表示されます。録画設定を行い、「予約登録」を押すことで予
　　　　約できます。

　　◆検索から◆
　　　　検索ボタンを押すと検索ダイアログが開きます。
　　　　キーワードなどで番組を検索し、録画設定を行い、検索結果から予約
　　　　登録ができます。
　　　　検索結果をダブルクリックすると予約登録ダイアログも表示されます。

　　◆自動予約登録から◆
　　　　条件をあらかじめ登録しておくことで、自動的に予約登録ができます。
　　　　（EPGデータが読み込まれたタイミングで追加されます。）

　　◆外部アプリから◆
　　　　対応している他のアプリから登録することも可能です。

　　◆iEPGから◆
　　　　iEPGファイルをEpgTimeの画面にD&DかEpgTimer.exeのコマンドライン
　　　　オプションにファイルパスを指定することで予約登録ができます。
　　　　iEPG Version1の場合はあらかじめ設定が必要です。

　●予約の削除方法
　　録画中の予約を削除すると録画がキャンセルされます。
　　◆予約一覧から◆
　　　　削除対象を選択して、「削除」ボタンを押す。もしくは右クリックメ
　　　　ニューから削除を選択してください。

　　◆使用予定チューナーから◆
　　　　削除対象をダブルクリックすると予約変更ダイアログが開きます。
　　　　「削除」ボタンを押すことで削除できます。
　　　　もしくは右クリックメニューから削除を選択してください。

　　◆番組表から◆
　　　　削除対象の番組をダブルクリックすると予約変更ダイアログが開きます。
　　　　「削除」ボタンを押すことで削除できます。
　　　　もしくは右クリックメニューから削除を選択してください。

　●予約の変更方法
　　録画中の予約を変更する場合は、次の項目のみ反映されます。
　　「追従あり／なし」、「録画後動作」、「終了マージン」、「録画後Bat」
　　（プログラム予約時は「終了時間」も反映）
　　◆予約一覧から◆
　　　　変更対象を選択して、「変更」ボタンを押す。もしくは右クリックメ
　　　　ニューから変更を選択してください。

　　◆使用予定チューナーから◆
　　　　変更対象をダブルクリックすると予約変更ダイアログが開きます。
　　　　「変更」ボタンを押すことで変更できます。
　　　　もしくは右クリックメニューから削除を選択してください。

　　◆番組表から◆
　　　　変更対象の番組をダブルクリックすると予約変更ダイアログが開きます。
　　　　「変更」ボタンを押すことで削除できます。
　　　　もしくは右クリックメニューから削除を選択してください。

　●EPGデータ取得の方法
　　利用可能な複数のチューナーがある場合は、すべての空きチューナーを使
　　用して取得を行ないます。EPG取得時間の削減になります。
　　◆自動取得◆
　　　　設定で取得する時間を指定することで、自動的に取得することができ
　　　　ます。
　　◆手動取得◆
　　　　「EPG取得」ボタンを押すことで、手動でEPG取得を開始できます。

　●予約録画の実行
　　予約録画の開始2分前（設定で変更可能）に録画用アプリを自動的に立ち
　　上げて行ないます。EpgTimerSrv.exeをサービスに登録にしている場合、
　　EpgTimer.exeを起動しておかないとGUIが表示されません。

　●番組検索
　　「検索」ボタンを押すことで検索ダイアログが表示されます。
　　EPGデータからキーワード、条件を指定して番組を検索します。
　　検索結果から予約の登録、現在の検索条件を自動予約登録に追加すること
　　ができます。
　　設定で検索条件と録画設定のデフォルト値を指定することができます。
　　EPGデータが取得されていないと、使用できません。
　　検索条件の詳細は後述。

◇各タブ
　●予約一覧
　　登録されている予約の一覧が表示されます。
　　右クリックでポップアップメニューも出ます。

　　・削除ボタン
　　　　予約一覧で選択されている項目を削除します。
　　　　録画中のものを削除した場合は、録画が中止されます。

　　・変更ボタン
　　　　予約一覧で選択した予約の設定を変更できます。録画中は
　　　　「追従あり／なし」、「録画後動作」、「終了マージン」、「録画後Bat」
　　　　のみ変更可能です。プログラム予約の場合は終了時間の変更も可能です。

　　・無効ボタン
　　　　予約一覧で選択されている項目の録画モードを無効に変更します。
　　　　自動予約登録で、必要のない予約が登録された場合に使用してください。
　　　　削除をすると、EPGデータ読み込み時に再度登録されてしまいます。

　　・プログラム予約追加ボタン
　　　　手動で時間指定の予約を追加するときに使用します。追従などEPGデー
　　　　タに依存する処理は行えません。

　　・追っかけ再生ボタン
　　　　録画中の予約の場合、UDP or TCPを使用してストリーミング配信を行
　　　　います。受信側はTVTestでBonDriver_TCP、BonDriver_UDPを使用した
　　　　ものを想定しています。
　　　　使用するには「EpgTimerPlugIn.tvtp」をTVTestのPlugInとして使用で
　　　　きる状態にし、TVTest連携の設定を行っておく必要があります。

　●使用予定チューナー
　　各予約が使用する予定のチューナーを確認することができます。
　　ドラッグすることでスクロールが可能です。
　　項目をダブルクリックすることで予約変更ダイアログが開きます。
　　右クリックでポップアップメニューも出ます。

　●録画済み一覧
　　録画の終了した項目が一覧表示されます。
　　項目をダブルクリックすることで録画情報が表示されます。（エラーログ
　　と番組情報ログを出力している必要があります）
　　右クリックでポップアップメニューも出ます。

　　・削除ボタン
　　　　選択されている項目を削除します。録画ファイルの削除などは行いま
　　　　せんので、別途手動で削除してください。

　　・再生ボタン
　　　　再生アプリが設定されている場合、または保存ファイルに関連付けさ
　　　　れているアプリケーションがある場合、起動します。
　　　　EpgTimerNWの場合は、UDP or TCPを使用してストリーミング配信を行
　　　　います。受信側はTVTestでBonDriver_TCP、BonDriver_UDPを使用した
　　　　ものを想定しています。
　　　　使用するには「EpgTimerPlugIn.tvtp」をTVTestのPlugInとして使用で
　　　　きる状態にし、TVTest連携の設定を行っておく必要があります。

　●自動予約登録
　　EPG予約とプログラム予約の自動予約条件が一覧表示されます。
　　条件を追加することで、EPGデータ読み込み時に自動的に予約登録を行います。
　　予約一覧、録画済み一覧の右クリックメニューから追加すると、キーワード
　　があらかじめ入力された状態で条件追加ダイアログを表示します。

　　・追加ボタン
　　　　条件追加ダイアログを表示します。新規に条件を追加する場合に使用します。

　　・削除ボタン
　　　　選択されている項目を削除します。

　　・変更ボタン
　　　　選択されている項目の条件変更ダイアログします。

　　・↑ボタン
　　　　選択されている項目を一つ上に移動します。
　　　　※1クリックごとに情報の更新が必要なため、連続での移動はできません。

　　・↓ボタン
　　　　選択されている項目を一つ下に移動します。
　　　　※1クリックごとに情報の更新が必要なため、連続での移動はできません。

　●番組表
　　読み込んでいるEPGデータを表示します。
　　設定でカスタマイズ表示にすることで、3種類の表示モード（標準モード、
　　1週間表示モード、リスト表示モード）とタブの追加が可能になります。

　　・標準モード
　　　通常のラテ欄表示モードです。
　　　ドラッグすることでスクロールが可能です。
　　　番組をダブルクリックすることで、予約登録、または予約変更ダイアロ
　　　グが開きます。
　　　TVTest連携の設定を行っていると、サービス名をダブルクリックするこ
　　　とでTVTestのチャンネルを切り替えることができます。
　　　詳細は後述の■TVTest連携■を参照。

　　　・日付ボタン
　　　　　各日付の0時の位置を表示します。

　　　・時間ボタン
　　　　　各日付の各時間の位置を表示します。

　　　・現在ボタン
　　　　　現在の時間の位置を表示します。

　　・1週間表示モード
　　　選択したサービスのみを横軸日付、縦軸時間で表示するモードです。
　　　番組をダブルクリックすることで、予約登録、または予約変更ダイアロ
　　　グが開きます。

　　　・現在ボタン
　　　　　現在の時間の位置を表示します。

　　・リスト表示モード
　　　チェックの入っているサービスの番組をリストで表示するモードです。
　　　番組をダブルクリックすることで、予約登録、または予約変更ダイアロ
　　　グが開きます。

　　　・全チェックボタン
　　　　表示サービスのすべてにチェックを入れます。

　　　・全クリアボタン
　　　　表示サービスのすべてのチェックをクリアします。

◇上段のボタン
　　表示するボタンは設定で変更可能です。

　　・設定ボタン
　　　　設定ダイアログを開きます。

　　・検索ボタン
　　　　検索ダイアログを開きます。

　　・スタンバイボタン
　　　　PCをスタンバイ状態に移行させます。

　　・休止ボタン
　　　　PCを休止状態に移行させます。

　　・EPG取得ボタン
　　　　EPGデータの取得を手動で開始します。

　　・EPG再読み込みボタン
　　　　EPGデータの再読み込みを行います。
　　　　再度自動予約登録を行いたい場合などに使用します。

　　・終了ボタン
　　　　EpgTimerを終了します。

　　・カスタム１ボタン
　　　　設定で表示を有効にしている場合表示されます。同時に外部アプリケー
　　　　ション設定で起動するアプリケーションを登録する必要があります。

　　・カスタム２ボタン
　　　　設定で表示を有効にしている場合表示されます。同時に外部アプリケー
　　　　ション設定で起動するアプリケーションを登録する必要があります。

　　・NetWorkTV終了
　　　　TVTest連携で起動したTVTestを終了します。

　　・情報通知ログ
　　　　バルーンチップで表示された内容の一覧を表示します。
　　　　表示内容は起動中のみ保持されます。

　　・再接続
　　　　EpgTimerNWのみ表示可能。
　　　　サーバーへの再接続を行うためのダイアログが表示されます。

■検索条件■
　EPGデータの検索を行う場合の条件です。
　検索、自動予約登録などで使用されます。

　・検索キーワード
　　EPGデータから検索対象とするキーワードを指定します。
　　過去に検索したキーワードの一覧を選択することもできます。
　　スペース区切りで複数指定できます。AND検索となります。
　　改行入力でスペースの代わりに改行でキーワードを入力することが可能で
　　す。

　・NOTキーワード
　　EPGデータから検索対象外とするキーワードを指定します。
　　過去に検索したキーワードの一覧を選択することもできます。
　　スペース区切りで複数指定できます。OR検索となります。
　　改行入力でスペースの代わりに改行でキーワードを入力することが可能で
　　す。

　・正規表現モード
　　入力する検索、NOTキーワードを正規表現として扱います。
　　※検索時にConvertText.txtにて指定された文字を置き換えたものから検索
　　　することになります。パターン作成時に注意してください。

　・あいまい検索モード
　　１、２文字の不一致であれば、検索結果に表示します。
　　正規表現モードとの併用はできません。

　・番組名のみ検索対象
　　番組名のみをキーワードの検索対象とします。番組情報は対象になり
　　ません。

　・ジャンル絞り込み
　　検索対象のジャンルを指定できます。コンボボックスから条件を選択
　　し、リストに追加します。
　　「NOT扱いにする」にチェックを入れると、追加されたジャンル全てを
　　検索対象外にします。
　　◆「追加」を押してリストに追加しないと有効になりません。

　・サービス絞込み
　　検索を行なうサービスを指定できます。
　　余分なサービスを省くことで検索時間の短縮にもなります。

　・時間絞り込み
　　検索対象の番組開始時間を指定できます。
　　期間か曜日毎で条件を指定してリストに追加します。
　　「NOT扱いにする」にチェックを入れると、追加された時間帯全てを
　　検索対象外にします。
　　◆「追加」を押してリストに追加しないと有効になりません。

　・スクランブル放送
　　検索対象に有料、無料番組を指定できます。

■録画設定■
　録画を行うときの設定値となります。
　
　　・録画モード
　　　録画モードを指定します。
　　　　全サービス：
　　　　　TSデータを書き換えないでそのまま保存します。
　　　　　1チャンネルで複数のサービスが存在する場合、全サービスが保存
　　　　　されます。
　　　　指定サービス：
　　　　　指定されたサービスに必要なデータのみを保存します。
　　　　　（PAT、PMTを書き換えます。）
　　　　全サービス（デコード処理なし）：
　　　　　スクランブル解除処理を行わない全サービスになります。
　　　　指定サービス（デコード処理なし）：
　　　　　スクランブル解除処理を行わない指定サービスになります。
　　　　視聴：
　　　　　録画動作を行わないで、録画アプリの起動のみを行います。
　　　　無効：
　　　　　録画動作を行いません。自動予約登録で不必要な番組が登録された
　　　　　場合に使用してください。（削除では再度登録されます。）

　　・追従
　　　追従処理のあり／なしを指定します。
　　　プログラム予約では指定できません。

　　・優先度
　　　予約の優先度を指定します。時間が重なり、チューナー不足が発生した
　　　場合、数値の高い予約が優先されて実行されます。

　　・ぴったり（？）録画
　　　PMTのバージョンが変わるか、EITのEventIDが変わったたタイミングで録
　　　画を開始し、EITのEventIDが変わったか、録画終了マージンに達したタイ
　　　ミングで録画を終了します。
　　　切り替わりは録画開始マージン～録画終了マージンの間で判断するので、
　　　マージンを０に設定しないでください。
　　　プログラム予約では指定できません。

　　・録画フォルダ
　　　デフォルト値から保存場所を変更したい場合、特定の出力PlugInを使用
　　　したい場合、特定のファイル名PlugInを使用した場合に使用します。
　　　複数指定することで全フォルダに出力します。
　　　※出力PlugIn、ファイル名PlugInの設定は全予約共通となります。変更
　　　　するとすべての予約に影響が出ます。
　　　　PlugInによってはファイル名を変更することで、複数の設定を使用す
　　　　ることができます。

　　・録画後動作
　　　録画後に行う動作を指定します。

　　・録画後実行bat
　　　録画後に実行するbatファイルを指定します。

　　・録画マージン
　　　録画開始、終了時間のマージンを指定できます。
　　　マイナス値を指定することで、番組の特定部分のみ録画することも可能
　　　です。

　　・指定サービス対象データ
　　　録画モードが指定サービスの場合、保存対象とするデータを指定できま
　　　す。

　　・部分受信サービス
　　　部分受信サービス（ワンセグ）のデータが存在する場合、別ファイルに
　　　同時に出力します。
　　　保存場所を変更したい場合、特定の出力PlugInを使用したい場合、特定
　　　のファイル名PlugInを使用したい場合はリストに追加することで変更で
　　　きます。
　　　複数指定することで全フォルダに出力します。

　　・連続録画動作
　　　同一サービスの連続した予約があり、同一チューナーで録画する場合、
　　　連続して1つのファイルに出力します。

　　・使用チューナー強制指定
　　　使用するチューナーを強制的に指定します。録画時に使用できなかった
　　　場合に別チューナーへの移行も行われません。
　　　チューナー構成（優先度含む）が変わった場合に、IDとBonDeriverの関
　　　連付けが変わる可能性があるため。個別に指定し直す必要があります。

■設定■
　●基本設定タブ
　　●保存フォルダ
　　※設定値はEpgDataCap_Bon.exeと共通となります。
　　・設定関係保存フォルダ
　　　チャンネル設定やEPGデータなどを保存するフォルダを指定します。

　　・録画用アプリのexe
　　　録画用に使用するアプリのexeを指定します。

　　・録画保存フォルダ
　　　即時録画時と予約録画時にファイルを保存するフォルダを指定します。
　　　複数登録することで、空きがなくなった場合のサブ録画フォルダを指
　　　定できます。
　　　◆「追加」を押してリストに追加しないと有効になりません。

　　・スタートアップにショートカットを作成する
　　　スタートアップにEpgTimerを起動するショートカットを作成します。
　　　必要なくなった場合、手動で削除してください。

　　●チューナー
　　利用可能な各BonDriverのチューナーの数とEPGデータの取得に使用するか
　　を設定します。
　　BonDriver一覧から設定を行うBonDriverを選択し、チューナーの数とEPG
　　データの取得に使用するかを設定します。
　　チューナー数は間違えると正常に予約録画を行なえません。
　　チューナーの優先度は一覧のリストの上にあるものが高いものになります。
　　EPG取得で使用するチューナーが増えるとEPG取得を分散して行うため、高
　　速に行えます。
　　◆設定変更後は一度EpgTimerを終了してください。◆
　　EpgTimerSrv.exeをサービスに登録している場合は一度サービスの停止を
　　行なってください。

　　●EPG取得設定タブ
　　※設定値はEpgDataCap_Bon.exeと共通となります。
　　EPGデータの自動取得を行う時間と対象サービスを設定します。
　　・EPG取得対象サービス
　　　EPGデータを取得するサービスにチェックを入れます。

　　・EPG取得時間
　　　EPG取得を行う時間をリストに追加して指定します。

　　・実行抑制条件
　　　指定時間内に予約がある場合にEPG取得動作を行わないようにします。

　　・使用チューナー条件
　　　指定時間以内に予約録画がある場合に、予約録画で使用するチューナー
　　　をEPG取得では使用しないようにします。


　●動作設定タブ
　　●録画動作
　　・録画、EPG取得終了後のデフォルト動作
　　　予約録画終了、EPGデータ自動取得後のデフォルト処理を設定します。
　　　・録画後動作
　　　　録画後に行うデフォルト動作を指定します。
　　　　抑制条件ではスタンバイ or 休止移行時に移行を抑制する条件を設定
　　　　します。
　　　・復帰処理開始時間
　　　　EPG取得、予約録画前にスタンバイ or 休止からの復帰処理を開始する
　　　　時間を指定します。
　　　　再起動ありの設定の場合は設定値に+5分されます。
　　　　PC環境に合わせて余裕のある時間を設定してください。
　　　・bat実行条件
　　　　録画後実行batがある場合、次の予約までに指定時間の空きがある場合
　　　　に実行します。
　　　　詳しくは後述の■録画後のバッチファイル実行の仕様■を参照

　　・録画時の処理
　　　予約録画時のデフォルト処理を設定します
　　　・録画マージン
　　　　開始時間の何秒前から録画を開始するか、終了時間の何秒後まで録画
　　　　するかを指定できます。
　　　　PC時計と実際の放送の誤差は自動的に補正するため、考慮する必要は
　　　　ありません。
　　　　マイナス値を指定すると、開始後、終了前になります。

　　　・録画用アプリ
　　　　録画用アプリ起動時、予約録画時の動作を設定します。
　　　　・開始？分前に起動する
　　　　　指定時間に録画用アプリの起動を行います。

　　　　・最小化で起動する
　　　　　最小化状態で起動します。

　　　　・視聴時はViewを起動する。
　　　　　録画モードが視聴の場合、EpgDataCap_Bon側でViewに指定されてい
　　　　　るアプリを録画開始のタイミングで起動します。
　　　　　◆起動したViewアプリは自動的に終了はしません

　　　　・ドロップログを出力する
　　　　　ドロップとスクランブルの状況を出力します。「.ts.err」となります。

　　　　・番組情報を出力する
　　　　　番組情報を出力します。「.ts.program.txt」となります。

　　　　・UDP、TCP送信を行う
　　　　　UDPとTCPの送信をON状態で起動します。

　　　　・同一ファイル名が存在した場合に上書きする
　　　　　同一ファイル名が存在した場合に上書きで出力します。

　　　　・プロセス優先度
　　　　　録画時に起動するプロセスの優先度を指定できます。

　　●予約情報管理処理
　　　・優先度が同じで時間が重なった場合は後の番組を優先する
　　　　予約が重なったときや、追従で重なったときの動作です。

　　　・イベントリレーによる追従を行う
　　　　イベントリレーが指定されている場合に、リレー先の番組も録画しま
　　　　す。

　　　・EPGデータ読み込み時、予約時と番組名が変わっていれば番組名を変更する
　　　　番組名の修正や変更があった場合に、自動的に変更します。

　　　・EPGデータ読み込み時、EventIDの変更を開始、終了時間のみで処理する
　　　　EventIDと番組名の変更が同時に行われた場合に対応できます。

　　　・HDDの空きが少ない場合は古い録画ファイルを自動的に削除する
　　　　録画時間とHDDの空き容量を確認して、空きが足りないと判断したと
　　　　きに「.ts」を自動的に削除します。
　　　　消したくないデータがある場合は注意してください。
　　　　◆追加設定で削除対象フォルダを追加してください。◆
　　　　詳しくは後述の■録画ファイル自動削除の仕様■を参照。

　　　・録画時のファイル名にPlugInを使用する
　　　　録画時のファイル名を指定したPlugInを使用してカスタマイズできま
　　　　す。標準のRecName_Macro.dllの詳細は後述を参照。

　　　・同一物理チャンネルで連続となるチューナーの使用を優先する
　　　　通常の予約割り振りでは、同一物理チャンネルで連続となる予約が存
　　　　在しても、チューナー優先度を優先して割り振りますが、同一物理チャ
　　　　ンネルを使用するチューナーに優先的に割り振ります。

　　●ボタン表示
　　　・上部表示ボタン
　　　　上部に表示するボタンのレイアウトを変更できます。
　　　　設定ボタンを非表示にすることはできません。

　　　・タスクアイコン右クリック表示項目
　　　　タスクアイコンの右クリックメニューで表示する項目を変更できます。

　　●その他
　　　・×ボタンで最小化する
　　　　×ボタンを押したときにEpgTimerを終了ではなく最小化します。

　　　・最小化で起動する
　　　　EpgTimerを次回起動するときに最小化状態で起動します。

　　　・検索条件のデフォルト値を設定
　　　　検索条件のデフォルト値を設定できます。

　　　・録画設定のデフォルト値を設定
　　　　録画設定のデフォルト値、プリセットを設定できます。
　　　　iEPGからの予約追加時はデフォルトのプリセットが使用されます。

　　　・ネットワーク接続を許可する
　　　　EpgTimerNWを使用する場合に設定します。

　　　・録画結果を自動的に削除する
　　　　指定した保持件数を超えた録画結果を古いものから削除します。
　　　　（録画ファイルの削除は行いません）

　　　・録画結果を自動的に削除する
　　　　指定した保持件数を超えた録画結果の履歴を自動的に削除します。
　　　　（録画ファイル自体の削除はおこなわれません。）

　　　・EPG取得時に放送波時間でPC時計を同期する
　　　　EPG取得時に放送波の時間情報を使用して、10秒以上の誤差がある場合
　　　　にPC時計を変更します。
　　　　Vista以降ではEpgTimerSrv.exeが管理者権限で起動している必要があ
　　　　ります。（サービスとして動作させるなど）

　　　・ツールチップの表示を抑制する
　　　　予約一覧やサービス、検索結果などで表示されるツールチップを表示
　　　　しないようにします。
　　　　番組詳細のツールチップ表示は影響を受けません。

　　　・バルーンチップでの動作通知を抑制する
　　　　バルーンチップによる情報通知表示しないようにします。

　　　・サーバー間連携
　　　　ネットワークを使用して別PCのEpgTimerSrv.exeと通信します。
　　　　登録サーバーはネットワーク接続が許可されている必要があります。
　　　　詳しくは後述の■サーバー間連携■を参照。
　　　　・サーバー間連携を有効にする
　　　　　サーバー間連携機能を有効にします。
　　　　・チューナー不足の予約を連携サーバーに登録する
　　　　　チューナー不足、一部のみ録画状態の予約を、連携サーバーに登録
　　　　　します。
　　　　・EPGデータを連携サーバーから取得する
　　　　　ローカル保存のEPGデータより1時間以上新しいEPGデータがあれば、
　　　　　EPGデータを取得します。
　　　　・他のサーバーからの予約登録を許可しない
　　　　　他のサーバーからの予約登録があった場合に、予約登録を行いません。
　　　　・他のサーバーからのEPGデータ取得を許可しない
　　　　　他のサーバーへのEPGデータのアップロードを行いません。

　　●カスタムボタンタブ
　　　2つのを登録できます。
　　　・表示名
　　　　ボタンに表示される文字を設定します。

　　　・実行exe
　　　　起動するexeのパスを指定します。

　　　・コマンドラインオプション
　　　　起動するexeのコマンドラインオプションを指定できます。

　　●iEPG Ver.1タブ
　　　iEPG Ver.1を使用する場合には、放送局名とサービス名を関連付ける必要
　　　があります。
　　　対象サービスを選択し、iEPGの放送局名を追加してください。
　　　サイトによって放送局名が変わる場合は、複数登録することが可能です。
　　　関連付けがないと予約登録ができません。

　　●Windowsサービス
　　　EpgTimerSrv.exeのサービス登録、解除などを行います。
　　　Vista以降のOSでは管理者権限で起動されている必要があります。
　　　バージョンアップなどを行う場合には一度サービスを停止する必要があ　
　　　ります。

　●番組表タブ
　　●基本
　　　使用予定チューナーと番組表のデフォルト表示、カスタマイズ表示の標
　　　準と1週間表示モードに影響のある設定です。
　　　・フォント
　　　　タイトルとタイトル以外の部分のフォントやサイズを指定できます。

　　　・表示
　　　小数点での指定も可能です。
　　　　・マウススクロールサイズ
　　　　　マウスホイールでスクロールする場合のサイズを指定します。
　　　　・1分あたりの高さ
　　　　　1分あたりの高さを指定できます。
　　　　・サービス1つの幅
　　　　　表示サービス1つの幅を指定できます。
　　　　・ドラッグスクロール倍率
　　　　　ドラッグでスクロールする場合の、倍率を指定できます。
　　　　・番組詳細をツールチップで表示する
　　　　　番組詳細をツールチップで表示します。
　　　　・番組内容表示位置を番組名表示位置にあわせる
　　　　　番組内容表示位置を番組名表示位置にあわせます
　　　　　（表示可能領域が増えます）

　　●色
　　　・ジャンル別背景色
　　　　番組表で表示する番組背景をジャンル別に指定することができます。
　　　　カスタムを選択し、横のボタンを押すことでカスタム色を指定できます。

　　　・予約枠
　　　　番組表で表示する予約枠の色を指定することができます。
　　　　塗りつぶしで表示にチェックすると枠内が塗りつぶされます。
　　　　カスタムを選択し、横のボタンを押すことでカスタム色を指定できます。

　　●表示項目
　　　・デフォルト表示
　　　　デフォルトの番組表示です。表示サービスの選択などを行いたい場合
　　　　は、カスタマイズ表示を行ってください。

　　　・カスタマイズ表示
　　　　番組表で表示するタブや、表示内容をカスタマイズしたものにします。
　　　　詳細は後述の■番組表のカスタマイズ■を参照。

　●外部アプリケーション
　　●TVTest連携タブ
　　　TVTestとの連係動作を行う場合に設定します。
　　　詳しくは後述の■TVTest連携■を参照
　　　・TVTest.exeパス
　　　　TVTest.exeへのパスを指定します。

　　　・コマンドラインオプション
　　　　起動時のコマンドラインオプションを指定できます。

　　　・視聴に使用するBonDriver
　　　　TVTestで使用するBonDriverを指定します。
　　　　（地デジ用１つ、BS/CS用１つを指定してください）

　　　・NetworkTVモード
　　　　EpgDataCap_BonからUDP or TCP送信で視聴するモードです。
　　　　UDPかTCPを有効にしてください。
　　　　ストリーミング再生時のデフォルト受信モードにもなります。

　　●ファイル再生
　　　TVTestとの連係動作を行う場合に設定します。
　　　・再生アプリのexeパス
　　　　再生アプリのexeへのパスを指定します。

　　　・コマンドラインオプション
　　　　起動時のコマンドラインオプションを指定できます。
　　　　「$FilePath$」マクロでファイル名を指定できます。

　　●Twitter設定タブ
　　　・Proxy設定
　　　　・Proxyを使用する
　　　　　Twitter機能を使用するときにProxyを使用します。
　　　　・IEから設定を取得する
　　　　　IEのProxy設定を取得します。自動検出やスクリプトからの取得になっ
　　　　　ている場合は、取得に時間がかかります。
　　　　・認証Proxy用ID
　　　　　認証が必要なProxyの場合、認証に使用するIDを設定します。
　　　　・パスワード
　　　　　認証が必要なProxyの場合、認証に使用するパスワードを設定します。
　　　　　◆設定内容はそのままTextで保存されるので、利用する場合は注意し
　　　　　てください。

　　　・Twitter設定
　　　　詳しくは後述の■Twitter機能■を参照
　　　　・Twitter機能を有効にする
　　　　　Twitter機能を有効にします。
　　　　・認証用URLを取得する
　　　　　暗証番号を取得するための認証用URLを取得します。
　　　　・暗証番号
　　　　　Twitter機能を使用するときに必要な暗証番号です。入力後「適用」を
　　　　　押してください。入力内容は保存されないので、次回起動時に入力値
　　　　　は表示されません。
　　　　・動作テスト
　　　　　暗証番号の認証が完了している場合、入力内容をツイートして動作を
　　　　　している確認ができます。
　　　　・有効にするツイート内容
　　　　　ツイートする状態を選択します。ツイート内容はマクロを使用してカ
　　　　　スタマイズが可能です。使い方は後述参照。
　　　　　入力フィールドが狭いので、テキストエディターで作成後にコピペを
　　　　　推奨。


■番組表のカスタマイズ■
　設定でカスタマイズ表示にすることで、番組表タブで表示される内容をカス
　タマイズできます。
　表示サービスの変更を行いたい場合などに使用してください。
　カスタマイズできる内容は以下のようなものがあります。
　・番組表タブ内に表示するタブを変更できる
　・表示モードを標準モード、1週間表示モード、リスト表示モードの3種類か
　　ら選べる
　・表示するサービスを選択できる
　・表示する番組のジャンルを選択できる
　・検索条件に合致した番組のみを表示できる
　・番組の存在しない時間帯を表示から省略できる

　右クリックメニューから表示モードを変更することができますが、設定自体
　は変更されないので、再度起動した場合は元の表示に戻ります。
　EpgTimerNWでは検索条件による表示にすることで、データ転送量を減らすこ
　とが可能です。
　追加できるタブに特に制限数はありませんが、多くなるとメモリ使用量も増
　えます。

■TVTest連携■
　EpgTimerPlugIn.tvtpをTVTestのPlugInとして使用することで、番組表から
　TVTestの起動とチャンネル切り換え、追っかけ再生、録画ファイルのスト
　リーミング再生が行えるようになります。
　予約録画時にチューナーが使用されていた場合、TVTestを自動的に終了する
　こともできます。
　◆TVTest側でPlugInにチェックを入れて有効にしてください。◆

　設定で視聴に使用するBonDriverに追加した物が、TVTest側で使用できるよう
　に設定されている必要があります。
　追っかけ再生、ストリーミング再生をするにはBonDriver_UDP.dllか
　BonDriver_TCP.dllが使用できるように設定されている必要があります。

■サーバー間連携■
　ネットワーク接続を許可し、サーバー間連携が有効になっているサーバーに
　対して、予約の登録と最新EPGデータの取得を行います。
　WOLによって連携サーバーを起動したりはしないので、10分程度お互いが起
　動している状態を作る必要があります。
　・予約登録連携
　　予約登録は、チューナー不足か一部のみ録画となっている予約を、別サー
　　バーに登録します。
　　登録される側のサーバーは、他のサーバーからの予約登録を許可し、予約
　　を実行できる状態（登録した場合にチューナー不足などにならない）の必
　　要があります。
　　登録時には優先度が１になり、録画フォルダや録画後動作などは登録され
　　る側のサーバーのデフォルト値となります。
　・EPGデータ連携
　　連携サーバーにローカルで保存しているEPGデータより、1時間以上更新日
　　時の新しいEPGデータがあった場合に、取得を行います。
　　アップロードする側のサーバーはアップロード中に処理が一部止まるため、
　　低速な回線での使用は推奨しません。

■録画ファイル自動削除の仕様■
　削除対象になるのは削除対象フォルダに指定されているフォルダ内にある
　「.ts」のファイル。ファイルの作成日時でソートし、古いものから必要空
　き容量が確保されるまで削除していきます。
　必要空き容量は、指定サービスのみで録画した場合のビットレートで計算さ
　れます。
　サービス毎のビットレートはBitrate.iniを編集することで変更することが
　可能です。
　同時に削除するファイルの拡張子を追加することも可能です。この場合、
　録画ファイルの「.ts」の部分を置き換えてファイルを削除します。
　「.program.txt」と「.err」を削除したい場合は「.ts.program.txt」と
　「.ts.err」とを指定することになります。


■録画時の仕様■
　・ファイル名の付け方
　　「日時(YYYYMMDDHHMM)内部処理ID-番組名.ts」で作成します。
　　PlugInを使用することで、ファイル名のフォーマットを変更することが可
　　能です。

　・空き容量の確保
　　予想録画容量分のHDDの空きを確保（できるだけ連続領域の確保）をしてか
　　ら録画を行います。
　　（※使用する出力PlugInによって機能しないことがあります）

　・HDDの空きがなくなった場合
　　録画保存フォルダが複数指定されている場合、空きのある別フォルダに分
　　割して録画を行います。
　　分割が発生した場合、コマンドプロンプトで「copy /b」などを使用して
　　ファイルの結合をしてください。
　　（※使用する出力PlugInによって機能しないことがあります）

　・エラーログ
　　「録画ファイル.err」のファイル名でDrop、Scrambleの発生状況をログ出
　　力します。設定で出力しないようにできます。

　・番組情報ログ
　　「録画ファイル.program.txt」のファイル名で番組情報を出力します。
　　EpgDataCap_Bonで表示されている内容と同じものです。
　　設定で出力しないようにできます。

■Write_AVIVO 出力PlugIn■
　Windows7 + RadeonHDな環境の場合のみ使用できるPlugInです。
　AVIVOをインストールすることで、リアルタイムエンコードをしながら保存
　できます。
　設定内容を複数保持したい場合は、DLLをリネームするなどして複数用意し
　てください。
　◆使用制限◆
　前の番組から映像のサイズや音声フォーマットが変わるような番組を録画す
　る場合は、正常に動作しない可能性が高いです。
　不安定な部分があると思うので、そのあたりを了承して使用してください。


■自動予約登録の仕様■
　利用するにはEPGデータが読み込まれている必要があります。
　登録した条件に合致する番組を自動的に予約登録します。
　自動登録のタイミングはEPGデータの読み込みを行った時になります。
　開始時間の過ぎている番組は登録対象になりません。
　複数の条件で同一の番組が予約対象になった場合、自動予約登録のリストで
　上位に表示されている条件で登録されます。
　ただし、録画モードで無効の条件があれば無効を優先します。


■スタンバイ、休止状態への移行■
　スタンバイか休止状態へ移行するには次の予約録画、またはEPGデータの自
　動取得時間までに復帰開始時間+2分以上の開きがある場合に移行します。
　抑制条件に登録されいるプロセスが起動していた場合は、移行をキャンセル
　します。
　登録はexeのファイル名（拡張子含む）を登録してください。exeへのフルパ
　スではありません。

　例：「aviutl.exe」が登録されていると、AviUtlを起動してエンコ中だった
　　　場合、スタンバイか休止には移行しません。


■iEPGの仕様■
　サポートしているiEPGはデジタル用のVer.2とアナログ用のVer.1です。
　Ver.1を使用するには、設定で放送局名とサービス名の関連づけを行ってお
　く必用があります。
　予約登録を行うには「tvpid」ファイルをEpgTimer上にドラッグ＆ドロップ
　するか、コマンドライン引数でファイルパスを指定してEpgTimerを起動し
　てください。
　テレビ王国のiEPGデジタルでの動作を確認しています。


■録画後のバッチファイル実行の仕様■
　スタンバイや休止への以降はバッチ処理終了後に行います。
　録画終了時に、他に予約録画が行なわれていない場合かつ、次の予約開始ま
　でに設定時間以上の空きがある場合に実行されます。
　この条件に当てはまらない場合は起動待ちの状態になり、実行可能条件を満
　たした場合に順に１つずつ実行します。
　実際の実行時にはEpgTimer.exeのあるフォルダに「EpgTimer_Bon_RecEnd.bat」
　というバッチファイルを新規作成し、登録したbatファイルの内容をコピーし
　て実行します。
　この時マクロを使用できます。使用可能マクロは後述
　バッチ起動待ちの状態でEpgTimerSrvを終了させるとバッチは実行されません。

　例：
　登録したbatファイルの中身が
　b25.exe "$FilePath$"
　だった場合、実行される場合は
　b25.exe "D:\TSData\録画ファイル.ts"
　のように変換されて実行されます。


■マクロ■
　バッチやRecName_Macro.dllで利用できるマクロの一覧です。

$FilePath$	ファイルのフルパス（バッチのみ）
$FileName$	ファイル名（拡張子なし）（バッチのみ）
$Title$		番組名（予約一覧の番組名に表示されているもの）
$Title2$	番組名（[]の括弧でくくられている部分を削除したもの）
$SDYYYY$	開始日の年4桁固定
$SDYY$		開始日の年2桁固定
$SDMM$		開始日の月2桁固定
$SDM$		開始日の月
$SDDD$		開始日の日2桁固定
$SDD$		開始日の日
$STHH$		開始時間の時2桁固定
$STH$		開始時間の時
$STMM$		開始時間の分2桁固定
$STM$		開始時間の分
$STSS$		開始時間の秒2桁固定
$STS$		開始時間の秒
$EDYYYY$	終了日の年4桁
$EDYY$		終了日の年2桁
$EDMM$		終了日の月2桁固定
$EDM$		終了日の月
$EDDD$		終了日の日2桁固定
$EDD$		終了日の日
$ETHH$		終了時間の時2桁固定
$ETH$		終了時間の時
$ETMM$		終了時間の分2桁固定
$ETM$		終了時間の分
$ETSS$		終了時間の秒2桁固定
$ETS$		終了時間の秒
$ONID10$	OriginalNetworkID 10進数
$TSID10$	TransportStreamID 10進数
$SID10$		ServiceID 10進数
$EID10$		EventID 10進数
$ONID16$	OriginalNetworkID 16進数
$TSID16$	TransportStreamID 16進数
$SID16$		ServiceID 16進数
$EID16$		EventID 16進数
$ServiceName$	サービス名（予約一覧の放送局に表示されているもの）
$SDYYYY28$	28時間表記開始日の年4桁固定
$SDYY28$	28時間表記開始日の年2桁固定
$SDMM28$	28時間表記開始日の月2桁固定
$SDM28$		28時間表記開始日の月
$SDDD28$	28時間表記開始日の日2桁固定
$SDD28$		28時間表記開始日の日
$STHH28$	28時間表記開始時間の時2桁固定
$STH28$		28時間表記開始時間の時
$EDYYYY28$	28時間表記終了日の年4桁
$EDYY28$	28時間表記終了日の年2桁
$EDMM28$	28時間表記終了日の月2桁固定
$EDM28$		28時間表記終了日の月
$EDDD28$	28時間表記終了日の日2桁固定
$EDD28$		28時間表記終了日の日
$ETHH28$	28時間表記終了時間の時2桁固定
$ETH28$		28時間表記終了時間の時
$DUHH$		番組総時間の時2桁固定（ファイル名：録画開始時の番組総時間、Bat：録画終了時の番組総時間）
$DUH$		番組総時間の時（ファイル名：録画開始時の番組総時間、Bat：録画終了時の番組総時間）
$DUMM$		番組総時間の分2桁固定（ファイル名：録画開始時の番組総時間、Bat：録画終了時の番組総時間）
$DUM$		番組総時間の分（ファイル名：録画開始時の番組総時間、Bat：録画終了時の番組総時間）
$DUSS$		番組総時間の秒2桁固定（ファイル名：録画開始時の番組総時間、Bat：録画終了時の番組総時間）
$DUS$		番組総時間の秒（ファイル名：録画開始時の番組総時間、Bat：録画終了時の番組総時間）
$Drops$		録画結果のドロップ数（バッチのみ）
$Scrambles$	録画結果のスクランブル数（バッチのみ）
$Result$	録画結果のコメント（バッチのみ）


■追従の仕様■
　追従処理には大きく2種類あります。
　・EPGデータ読み込み時に、読み込んだEPGデータから追従を行う
　　主に録画開始前の予約が対象になります。
　　録画中の追従で変更が検知された予約はEPGデータの読み込みでの追従は
　　処理されません。
　・録画中にEpgDataCap_Bon.exeの蓄積しているEPGデータから追従を行う
　　主に録画中の予約と開始6時間以内の予約が対象になります。

　　蓄積データから時間変更が検知された場合：
　　　開始と終了時間を変更します。

　　録画番組の終了時間が未定になった場合：
　　　未定となっている間、録画終了時間を現在の時刻+10分に変更して録画
　　　処理を行います。
　　　終了時間未定のまま番組が終わった場合、番組終了から10分後に録画が
　　　終わることになります。
　　　終了時間が再度決定すれば、決定時間に変更されます。
　　　録画中の番組が番組的に終了し、EPGデータ的に突然次の番組になった
　　　り、不正な状態になると録画を終了します。（NHK）

　　録画番組の開始時に終了未定の番組が放送されていた場合：
　　　録画終了1分前まで一端録画を行い、その後開始時間を現在の時刻-30秒
　　　とし、再度録画処理を行います。
　　　デフォルト6時間以上、未定の状態が続いた場合は追従処理をやめます。
　　　終了時間は決定したが、録画時間内に放送時間が決定しなければ、追従
　　　できずに録画は終了してしまいます。

　　録画番組の開始時に終了未定の番組はなく、EventIDの同じ番組が見つからなかった場合：
　　　終了予定時間まで録画し、そのまま終了します。
　　　現在放送中の番組名が、予約番組のタイトルと似ている物の場合（あい
　　　まい検索処理）EventIDが変更されたとして、追従処理を行います。
　　　EventIDと開始時間が変わったが、終了予定時間までに放送がされなけ
　　　れば追従は行われません。
　　　この場合、放送は確定しているはずなので、録画中にEPG取得を行うよ
　　　うにしていれば取得完了後にEPGデータの読み込みが行われ、自動予約
　　　登録で別番組として登録されると思います。


■追従で失敗する例■
　・予約１：ch13 0:00～0:30　予約２：ch20 0:30～1:00
　　優先度同じで、後の番組優先の設定。
　　ch13で開始10分遅れが発生、ch20で10分以上の遅れが発生したとする。

　　問題なく予約できそうだけど予約１が実行されません。
　　予約２は予約１とチャンネルが違うため、番組情報取得できずに0:30開始
　　のままと判断します。そのため0:30の時点で予約１が終わらないため、予
　　約１を実行しません。

■Twitter機能■
　特定の動作状況をTwitterにツイートする機能です。次のような状態が発生し
　た場合にツイートします。
　・EPG読み込み時の変更検知
　　EPG読み込み時にすでに登録済みの予約の内容で追従処理が発生した場合
　・録画中の変更検知
　　録画中に追従処理が発生した場合
　・EPG自動予約登録の検知
　　EPGでの自動予約登録が発生した場合（無効を除く）
　・録画開始
　　録画を開始した場合
　・録画終了
　　録画を終了した場合

　ツイートする内容は以下のマクロを使用することでカスタマイズすることが
　可能です。「EPG読み込み時の予約変更検知」、「録画中の予約変更検知」
　の場合はOLD系が変更前、NEW系が変更後、他のものはNEW系が追加や動作内容
　で使用できるものになります。
　最終的なツイート内容が140文字を超える場合は、「…」を使用して省略され
　ます。

◆変更前
$TitleOLD$		番組名（予約一覧の番組名に表示されているもの）
$SDYYYYOLD$		開始日の年4桁固定
$SDYYOLD$		開始日の年2桁固定
$SDMMOLD$		開始日の月2桁固定
$SDMOLD$		開始日の月
$SDDDOLD$		開始日の日2桁固定
$SDDOLD$		開始日の日
$STHHOLD$		開始時間の時2桁固定
$STHOLD$		開始時間の時
$STMMOLD$		開始時間の分2桁固定
$STMOLD$		開始時間の分
$STSSOLD$		開始時間の秒2桁固定
$STSOLD$		開始時間の秒
$EDYYYYOLD$		終了日の年4桁
$EDYYOLD$		終了日の年2桁
$EDMMOLD$		終了日の月2桁固定
$EDMOLD$		終了日の月
$EDDDOLD$		終了日の日2桁固定
$EDDOLD$		終了日の日
$ETHHOLD$		終了時間の時2桁固定
$ETHOLD$		終了時間の時
$ETMMOLD$		終了時間の分2桁固定
$ETMOLD$		終了時間の分
$ETSSOLD$		終了時間の秒2桁固定
$ETSOLD$		終了時間の秒
$ONID10OLD$		OriginalNetworkID 10進数
$TSID10OLD$		TransportStreamID 10進数
$SID10OLD$		ServiceID 10進数
$EID10OLD$		EventID 10進数
$ONID16OLD$		OriginalNetworkID 16進数
$TSID16OLD$		TransportStreamID 16進数
$SID16OLD$		ServiceID 16進数
$EID16OLD$		EventID 16進数
$ServiceNameOLD$	サービス名（予約一覧の放送局に表示されているもの）
$SDYYYY28OLD$	28時間表記開始日の年4桁固定
$SDYY28OLD$		28時間表記開始日の年2桁固定
$SDMM28OLD$		28時間表記開始日の月2桁固定
$SDM28OLD$		28時間表記開始日の月
$SDDD28OLD$		28時間表記開始日の日2桁固定
$SDD28OLD$		28時間表記開始日の日
$STHH28OLD$		28時間表記開始時間の時2桁固定
$STH28OLD$		28時間表記開始時間の時
$EDYYYY28OLD$	28時間表記終了日の年4桁
$EDYY28OLD$		28時間表記終了日の年2桁
$EDMM28OLD$		28時間表記終了日の月2桁固定
$EDM28OLD$		28時間表記終了日の月
$EDDD28OLD$		28時間表記終了日の日2桁固定
$EDD28OLD$		28時間表記終了日の日
$ETHH28OLD$		28時間表記終了時間の時2桁固定
$ETH28OLD$		28時間表記終了時間の時
$DUHHOLD$		番組総時間の時2桁固定
$DUHOLD$		番組総時間の時
$DUMMOLD$		番組総時間の分2桁固定
$DUMOLD$		番組総時間の分
$DUSSOLD$		番組総時間の秒2桁固定
$DUSOLD$		番組総時間の秒
◆変更後、追加、録画開始、録画終了
$TitleNEW$		番組名（予約一覧の番組名に表示されているもの）
$SDYYYYNEW$		開始日の年4桁固定
$SDYYNEW$		開始日の年2桁固定
$SDMMNEW$		開始日の月2桁固定
$SDMNEW$		開始日の月
$SDDDNEW$		開始日の日2桁固定
$SDDNEW$		開始日の日
$STHHNEW$		開始時間の時2桁固定
$STHNEW$		開始時間の時
$STMMNEW$		開始時間の分2桁固定
$STMNEW$		開始時間の分
$STSSNEW$		開始時間の秒2桁固定
$STSNEW$		開始時間の秒
$EDYYYYNEW$		終了日の年4桁
$EDYYNEW$		終了日の年2桁
$EDMMNEW$		終了日の月2桁固定
$EDMNEW$		終了日の月
$EDDDNEW$		終了日の日2桁固定
$EDDNEW$		終了日の日
$ETHHNEW$		終了時間の時2桁固定
$ETHNEW$		終了時間の時
$ETMMNEW$		終了時間の分2桁固定
$ETMNEW$		終了時間の分
$ETSSNEW$		終了時間の秒2桁固定
$ETSNEW$		終了時間の秒
$ONID10NEW$		OriginalNetworkID 10進数
$TSID10NEW$		TransportStreamID 10進数
$SID10NEW$		ServiceID 10進数
$EID10NEW$		EventID 10進数
$ONID16NEW$		OriginalNetworkID 16進数
$TSID16NEW$		TransportStreamID 16進数
$SID16NEW$		ServiceID 16進数
$EID16NEW$		EventID 16進数
$ServiceNameNEW$	サービス名（予約一覧の放送局に表示されているもの）
$SDYYYY28NEW$	28時間表記開始日の年4桁固定
$SDYY28NEW$		28時間表記開始日の年2桁固定
$SDMM28NEW$		28時間表記開始日の月2桁固定
$SDM28NEW$		28時間表記開始日の月
$SDDD28NEW$		28時間表記開始日の日2桁固定
$SDD28NEW$		28時間表記開始日の日
$STHH28NEW$		28時間表記開始時間の時2桁固定
$STH28NEW$		28時間表記開始時間の時
$EDYYYY28NEW$	28時間表記終了日の年4桁
$EDYY28NEW$		28時間表記終了日の年2桁
$EDMM28NEW$		28時間表記終了日の月2桁固定
$EDM28NEW$		28時間表記終了日の月
$EDDD28NEW$		28時間表記終了日の日2桁固定
$EDD28NEW$		28時間表記終了日の日
$ETHH28NEW$		28時間表記終了時間の時2桁固定
$ETH28NEW$		28時間表記終了時間の時
$DUHHNEW$		番組総時間の時2桁固定
$DUHNEW$		番組総時間の時
$DUMMNEW$		番組総時間の分2桁固定
$DUMNEW$		番組総時間の分
$DUSSNEW$		番組総時間の秒2桁固定
$DUSNEW$		番組総時間の秒
◆録画中の変更のみ
$SYMDHMNEW$		開始日時の年月日時分（番組情報が開始未定の場合は「未定」となる）
$SYMDHM28NEW$	28時間表記開始日時の年月日時分（番組情報が開始未定の場合は「未定」となる）
$EYMDHMNEW$		終了日時の年月日時分（番組情報が終了未定の場合は「未定」となる）
$EYMDHM28NEW$	28時間表記終了日時の年月日時分（番組情報が終了未定の場合は「未定」となる）
$SEYMDHMNEW$	開始～終了日時の年月日時分（番組情報が未定の場合は「未定」となる）
$SEYMDHM28NEW$	28時間表記開始～終了日時の年月日時分（番組情報が未定の場合は「未定」となる）
◆録画終了のみ
$Drops$		録画結果のドロップ数
$Scrambles$	録画結果のスクランブル数
$Result$	録画結果のコメント


■Q&A■
・なんで.Net Framework使うようになったの？
＝＞MFCで作るには面倒な使い勝手系な要望が多いため。
　　あとは低スペックマシンを排除するため。GUI的に軽そうに見えても、内
　　部処理はいろいろやってるので、それなりにメモリとCPUを使用します。
　　（例：PT2使用時
　　PTCtrl.exe（64MB＋24MB×起動チューナー数）＋
　　BonDriver_PT-*.dll（24MB）＋EpgDataCap_Bon.exe（96MB）＝ 
　　TSのバッファのみで1チューナー最大208MB使用）
　　複数チューナー使用がデフォルト環境になりつつあると思うので、マルチ
　　コアCPUの環境を推奨。
　　WPF使ってるので、描画にハードウェア支援を受けられるVista以降（推奨7）
　　のOSを使用することを推奨。
　　OSのサポート期間的にも7への移行を推奨

・最初何すればいいの？
＝＞txtファイル全部読んでください。

・使用予定チューナーで違うチャンネルが同じチューナー使うようになってる
＝＞OriginalNetworkIDとTransportStreamIDが同じサービスは同一のチャンネル
　　のはずですので、使用チューナー削減のため同じチューナーを使うようにし
　　ました。

・予約割り振りの仕方を詳しく
＝＞開始時間と優先度で予約をソート→
　　BonDriverの優先度順に予約を追加。チューナーの指定あればそのまま追加。
　　別チャンネルで連続となる場合は仮登録。チューナー不足で時間が重なるも
　　のは後回し→
　　仮登録したもので、別チューナーの空きがあればそちらを使用→
　　チューナー不足のものは1分でも録画可能ならBonDriverの優先度順に追加。

・開始と終了時間重なっているときの動作を詳しく
＝＞同一チャンネルの場合はマージンを考慮した、そのままの動作になります。
　　別チャンネルの場合
　　◇前の終了時間＝後の開始時間の場合
　　　・前の番組の優先度が高いとき
　　　　　終了マージンを無視し、前の番組が終了した時点で後の番組の録画を
　　　　　開始します。（後ろの番組の頭が切れます）
　　　・後の番組の優先度が高いとき
　　　　　前の番組の終了15秒前に前の番組を終了し、後の番組の録画を開始し
　　　　　ます。（前の番組の後ろが切れます）
　　◇前の終了時間＝後の開始時間ではない場合
　　　・前の番組の優先度が高いとき
　　　　　終了マージンを無視し、前の番組が終了した時点で後の番組の録画を
　　　　　開始します。（後ろの番組の頭が切れます）
　　　・後の番組の優先度が高いとき
　　　　　後の番組の開始マージン＋開始15秒前に前の番組を終了し、後の番組
　　　　　の録画を開始します。（前の番組の後ろが切れます）

・PC起動時に自動的に起動できない？
＝＞EpgTimerSrv.exeをサービスに登録するか、EpgTimer.exeをスタートアップ
　　にでも登録してください。

・録画中にEpgDataCap_Bon.exeのGUIがない
＝＞EpgTimerSrv.exeをサービス登録した場合、EpgTimer.exeが起動していない
　　と表示されません。
　　これはOSの仕様です。サービス登録したexeはGUIを表示できない仕様に
　　なっています。（サービス登録したexeから起動したexeも含む）

・休止状態に入るときに「システム リソースが不足するため、API を終了でき
　ません。」てエラーが出るんだけど
＝＞1GB以上のメモリを積んでる環境で発生するOSのバグみたいです。
　　これを確認してみてください。
　　http://support.microsoft.com/kb/909095/ja

・検索にサービスが表示されない
＝＞有効なEPGデータが存在しない可能性があります。
　　EPGデータの取得を行ってみてください。

・EPGデータが消えた
＝＞1週間以上前のファイルは削除するようになっています。

・BS2録画したら(ry
＝＞デジタル放送の基本となる部分なのでチャンネルとサービスの仕組みを勉
　　強してください。

・Reserve.txtのフォーマットどうなってるの？
＝＞タブ区切り（\t）で次の項目順になっています。最後には改行がいります。
日付　　：YYYY/MM/DD形式
開始時間：HH:MM:SS形式
総時間　：HH:MM:SS形式
番組名　：通常の文字列
放送局名：通常の文字列
OriginalNetworkID：10進数
TransportStreamID：10進数
ServiceID：10進数
EventID ：10進数
優先度　：1～5
追従有無：0:しない 1:する
ID　　　：内部で使用するID
録画モード：0:全サービス 1:指定サービス 2:全サービス(B25なし) 3:指定サービス(B25
　　　　　　なし) 4:視聴 5:無効
ぴったり（？）録画 ：0:しない 1:する
録画後bat：0 or なし：しない バッチファイルのパス：する
拡張用3 ：0
コメント：通常の文字列（録画結果など）
録画フォルダ：「パス*出力PlugIn名*ファイル名PlugIn名」（なしでデフォルト）
録画後動作：0:デフォルト設定 1:スタンバイ 2:休止 3:シャットダウン 4:何もしない
復帰後再起動：0:しない 1:する
録画済みファイル：ファイルのフルパス
録画マージン：0:デフォルト 1:個別
開始マージン：10進数
終了マージン：10進数
指定サービスモード：0:デフォルト 17:字幕追加 33:データ放送追加 49:両方追加
予約登録時の日付：YYYY/MM/DD形式
予約登録時の開始時間：HH:MM:SS形式
複数録画フォルダ：2つ上指定時の2つめ以降を\t区切りの「パス*出力PlugIn名*ファイル名PlugIn名」で
連続録画：0:しない 1:する
部分受信同時出力：0:しない 1:する
強制使用チューナーID：0:自動
予約追加状態：0
部分受信複数録画フォルダ：\t区切りの「パス*出力PlugIn名*ファイル名PlugIn名」で

・プログラム的に登録する方法は？
＝＞名前付きパイプ使ってコマンド送ればいろいろと行えます。
　　Common\SendCtrlCmd.hあたりを使用してもらえればいいかと。

　　Reserve.txtに項目を直接追加することでも可能です。
　　このときIDは0にしてください。
　　EpgTimerがID 0のものは新規追加されたものと判断します。
　　追加が完了した後にEpgTimer.exeを実行してください。オプションは特に
　　必要ありません。
　　EpgTimer起動中に再度起動しようとするとReserve.txtの再読み込みが発
　　生します。
　　一度に複数登録する場合は、すべての項目をReserve.txtに追加してから
　　EpgTimer.exeを実行してください。
　　項目が肥大化してきたため、名前付きパイプ使ってコマンド送ってもらう
　　方を推奨。

・いつの間にか自動登録で同じの２つ登録されているんだけど
＝＞BSの難視聴チャンネルの可能性があります。
　　また、検索対象のサービスが複数指定されている可能性があります。
　　＊＊＊１、＊＊＊２、＊＊＊３などとなっているもの。
　　現在と次の番組情報は3サービスともある程度の情報が配信されるため、
　　EPG取得のタイミングによっては検索にひっかかります。

・iEPGからの登録ができない
＝＞Ver.1の場合は放送局とサービスの関連付けをあらかじめ設定する必要が
　　あります。
　　Ver.2の場合は、登録対象のサービスがチャンネルスキャンで見つかって
　　いない可能性があります。

・予約一覧に背景赤や黄色の項目がある
＝＞時間が重なって録画できない予約があります。
　　赤が実行されない予約。
　　黄が時間が重なって一部のみ録画される予約になります。
　　灰色は録画モードが無効にされたものです。

・なんかタスクトレイのアイコンが変わってる
＝＞通常状態では青、予約録画時は赤、EPG取得時は緑に変わります。

・予約登録方法いろいろあるけど何がいいの？
＝＞自動予約登録>番組表>検索>>>>>>>>>>>>>>iEPG>プログラム予約系

・スタンバイ or 休止からうまく復帰しない
＝＞復帰関係はPC側の問題が大半になります。スタンバイ or 休止に対応して
　　いなパーツを搭載している可能性が高いです。

・○○に失敗するお
＝＞エスパー能力はないのでエスパーの人でも探してきてください。

・動作ログとかないの？
＝＞汎用のデバッグ出力（OutputDebugString）を使用しています。
　　DbgMonやDebugViewなどを使用して取得することができます。

・前のバージョンにあった○○はどうなったの？
＝＞基本的には需要がないだろうと判断したため、削除しました。

・NetworkTVモードでチャンネルが切り替わらなくなった
＝＞録画などでチューナーが奪われた可能性があります。
　　空きチューナーある場合は、別チューナー立ち上げているので、受信ポー
　　トを変更してみてください。

・EPG取得でBS、CS1、CS2の基本情報のみ取得て何？
＝＞BS、CS1、CS2は1チャンネルから全チャンネルの基本情報を取得できます。
　　そのため、詳細情報がいらなければ1チャンネルだけEPGデータの取得を行
　　うことでEPG取得に長時間かける必要がなくなります。
　　逆に取得対象サービスのEPGだけを取得するということはできません。
　　全サービスの詳細を取得しようとするとおよそ90分近くかかります。

・.ts.errの時間ログでDrop数（またはScramble数）の合計値があってない
＝＞時間によるログは5秒おきに前回と違う場合に出力するようになっています。
　　そのため、録画終了直前に発生したものは時間ログに出力されない可能性
　　があります。
　　リアルタイムに出力しないのは、ログの量が膨大になるのを防ぐためです。

・スタンバイ抑制条件でも休止に入るんだけど
＝＞Vista以降のOSではユーザー操作や別アプリの実行する、スタンバイ/休止
　　への移行をキャンセルすることはできなくなっています。OSの仕様なので
　　どうすることもできません。

・WMPで録画ファイル再生したら音が出なくなった
＝＞Windows7 SP1を使用している場合、WMPのバグか仕様変更により音が出な
　　い場合があるようです。
　　再生アプリの指定を行える設定を復活させたので、他の再生アプリを試
　　してみてください。

・追従できるだけ失敗しないための対策とかある？
＝＞野球が終わっているだろう23:00～0:00ぐらいにEPG取得を行うようにして
　　いれば、編成決定後のEPGデータを取得できている可能性が高いです。
　　EPG読み込み時の追従処理で、録画中ではなく、あらかじめ追従ができると
　　思います。
　　視聴時のEPGデータ取得を有効にし、録画アプリ起動開始時間を多めにする
　　ことで、録画直前のEPGデータを取得することも可能です。

★以下わかる人用★
■空き容量の計算値などを変更する■
　Bitrate.iniを編集することで、空き容量計算に使用するビットレートの値
　を変更することができます。
　録画ファイル自動削除時の空き容量計算と、録画開始時のHDDの空き確保処
　理に影響が出ます。
　地デジは地域によってServiceIDなどが違うため、サービスによって個別に
　指定したい場合は追加してください。

■キーワード検索の置き換え文字を変更する■
　ConvertText.txtを編集することで、EPGのキーワード検索時に内部処理で置
　き換える文字を追加できます。
　タブ区切りで、左の文字列が見つかれば、右の文字列に置き換えています。
　何かの単語を略語にするなど。

■自動予約登録で予約対象期間を指定する■
　自動予約登録で予約対象は何日後までにするか指定することができます。
　EpgTimerSrv.iniのSETにAutoAddDaysを追加することで日単位で変更可能です。
　（デフォルト8日）
　予約件数が多く負荷が高くなる場合などに使用してください。

■自動予約登録でイベントグループを無視して登録する■
　イベントグループを考慮して予約登録をするか指定することができます。
　EpgTimerSrv.iniのSETにChkGroupEventを追加することで変更可能です。
　0:考慮しない、1:考慮する（デフォルト 1）

■追従動作のカスタマイズ■
　延長などはいろいろなパターンがあるため、いくつか追従処理を変更できる
　ようにしています。
　・現在と次の番組情報存在しない場合に、録画時間を延ばせる設定
　　EpgTimerSrv.iniのSETにNoEpgTuijyuMinを追加することで分単位で変更可
　　能。録画終了2分前に番組情報が存在しなかった場合に延長。
　　（デフォルト30分）
　　放送事故でEPGデータが配信されていない場合などに有効。
　・録画中に総時間が変わった場合、録画時間を延ばす設定
　　EpgTimerSrv.iniのSETにDuraChgMarginMinを追加することで分単位で変更
　　可能。
　　（デフォルト0分）
　　延長後、さらに延長時にEPGの更新が終了時間後に行われるような場合など
　　に有効。
　・録画時間中に時間未定の番組がある場合、継続追従を行う時間を設定
　　EpgTimerSrv.iniのSETにTuijyuHourを追加することで時間単位で変更可能。
　　（デフォルト6時間）

■予約割り振りのアルゴリズムの変更■
　チューナー数に余裕のない環境で、同一サービスの予約を同じチューナーに
　割り当てやすいアルゴリズムに変更します。
　ただし、デフォルトからは処理量が増えるため、大量に予約登録している環
　境などでは、予約割り振りの処理に時間がかかる可能性があります。
　EpgTimerSrv.iniのSETにReloadBankMapAlgoを追加することで変更可能です。
　0:デフォルトアルゴリズム、1:アルゴリズム1（デフォルト 0）
